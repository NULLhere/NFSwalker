"""
NFS protocol constants and definitions
"""

# RPC Program Numbers
PMAP_PROG = 100000
PMAP_VERS = 2
PMAP_PROC_GETPORT = 3

MOUNT_PROG = 100005
MOUNT_VERS_1 = 1
MOUNT_VERS_3 = 3
MOUNT_PROC_MNT = 1
MOUNT_PROC_UMNT = 3

NFS_PROG = 100003
NFS_VERS_2 = 2
NFS_VERS_3 = 3
NFS_VERS_4 = 4

# NFS v2 Procedures
NFS2_PROC_NULL = 0
NFS2_PROC_GETATTR = 1
NFS2_PROC_SETATTR = 2
NFS2_PROC_LOOKUP = 4
NFS2_PROC_READDIR = 16
NFS2_PROC_READ = 6
NFS2_PROC_WRITE = 8

# NFS v3 Procedures
NFS3_PROC_NULL = 0
NFS3_PROC_GETATTR = 1
NFS3_PROC_SETATTR = 2
NFS3_PROC_LOOKUP = 3
NFS3_PROC_ACCESS = 4
NFS3_PROC_READDIR = 16
NFS3_PROC_READ = 6
NFS3_PROC_WRITE = 7
NFS3_PROC_CREATE = 8
NFS3_PROC_REMOVE = 12

# NFS v4 Procedures
NFS4_PROC_NULL = 0
NFS4_PROC_COMPOUND = 1

# NFSv4 Operations (for COMPOUND procedure)
OP_ACCESS = 3
OP_CLOSE = 4
OP_COMMIT = 5
OP_CREATE = 6
OP_DELEGPURGE = 7
OP_DELEGRETURN = 8
OP_GETATTR = 9
OP_GETFH = 10
OP_LINK = 11
OP_LOCK = 12
OP_LOCKT = 13
OP_LOCKU = 14
OP_LOOKUP = 15
OP_LOOKUPP = 16
OP_NVERIFY = 17
OP_OPEN = 18
OP_OPENATTR = 19
OP_OPEN_CONFIRM = 20
OP_OPEN_DOWNGRADE = 21
OP_PUTFH = 22
OP_PUTPUBFH = 23
OP_PUTROOTFH = 24
OP_READ = 25
OP_READDIR = 26
OP_READLINK = 27
OP_REMOVE = 28
OP_RENAME = 29
OP_RENEW = 30
OP_RESTOREFH = 31
OP_SAVEFH = 32
OP_SECINFO = 33
OP_SETATTR = 34
OP_SETCLIENTID = 35
OP_SETCLIENTID_CONFIRM = 36
OP_VERIFY = 37
OP_WRITE = 38

# NFSv4.1 Operations (additional operations for sessions)
OP_EXCHANGE_ID = 42
OP_CREATE_SESSION = 43  
OP_DESTROY_SESSION = 44
OP_SEQUENCE = 53

# NFSv4 File types
NF4_REG = 1    # Regular file
NF4_DIR = 2    # Directory
NF4_BLK = 3    # Block device
NF4_CHR = 4    # Character device  
NF4_LNK = 5    # Symbolic link
NF4_SOCK = 6   # Socket
NF4_FIFO = 7   # FIFO
NF4_ATTRDIR = 8 # Attribute directory
NF4_NAMEDATTR = 9 # Named attribute

# NFSv4 Open flags
OPEN4_SHARE_ACCESS_READ = 1
OPEN4_SHARE_ACCESS_WRITE = 2
OPEN4_SHARE_ACCESS_BOTH = 3

OPEN4_SHARE_DENY_NONE = 0
OPEN4_SHARE_DENY_READ = 1
OPEN4_SHARE_DENY_WRITE = 2
OPEN4_SHARE_DENY_BOTH = 3

# NFSv4 Create types
NF4_UNCHECKED = 0
NF4_GUARDED = 1  
NF4_EXCLUSIVE = 2

# NFSv4 Attribute IDs
FATTR4_SUPPORTED_ATTRS = 0
FATTR4_TYPE = 1
FATTR4_FH_EXPIRE_TYPE = 2
FATTR4_CHANGE = 3
FATTR4_SIZE = 4
FATTR4_LINK_SUPPORT = 5
FATTR4_SYMLINK_SUPPORT = 6
FATTR4_NAMED_ATTR = 7
FATTR4_FSID = 8
FATTR4_UNIQUE_HANDLES = 9
FATTR4_LEASE_TIME = 10
FATTR4_RDATTR_ERROR = 11
FATTR4_FILEHANDLE = 19
FATTR4_FILEID = 20
FATTR4_FILES_AVAIL = 21
FATTR4_FILES_FREE = 22
FATTR4_FILES_TOTAL = 23
FATTR4_FS_LOCATIONS = 24
FATTR4_HIDDEN = 25
FATTR4_HOMOGENEOUS = 26
FATTR4_MAXFILESIZE = 27
FATTR4_MAXLINK = 28
FATTR4_MAXNAME = 29
FATTR4_MAXREAD = 30
FATTR4_MAXWRITE = 31
FATTR4_MIMETYPE = 32
FATTR4_MODE = 33
FATTR4_NO_TRUNC = 34
FATTR4_NUMLINKS = 35
FATTR4_OWNER = 36
FATTR4_OWNER_GROUP = 37
FATTR4_QUOTA_AVAIL_HARD = 38
FATTR4_QUOTA_AVAIL_SOFT = 39
FATTR4_QUOTA_USED = 40
FATTR4_RAWDEV = 41
FATTR4_SPACE_AVAIL = 42
FATTR4_SPACE_FREE = 43
FATTR4_SPACE_TOTAL = 44
FATTR4_SPACE_USED = 45
FATTR4_SYSTEM = 46
FATTR4_TIME_ACCESS = 47
FATTR4_TIME_ACCESS_SET = 48
FATTR4_TIME_BACKUP = 49
FATTR4_TIME_CREATE = 50
FATTR4_TIME_DELTA = 51
FATTR4_TIME_METADATA = 52
FATTR4_TIME_MODIFY = 53
FATTR4_TIME_MODIFY_SET = 54
FATTR4_ACL = 12

# NFSv4 Status codes (additional to NFS3)
NFS4_OK = 0
NFS4ERR_PERM = 1
NFS4ERR_NOENT = 2
NFS4ERR_IO = 5
NFS4ERR_NXIO = 6
NFS4ERR_ACCESS = 13
NFS4ERR_EXIST = 17
NFS4ERR_XDEV = 18
NFS4ERR_NOTDIR = 20
NFS4ERR_ISDIR = 21
NFS4ERR_INVAL = 22
NFS4ERR_FBIG = 27
NFS4ERR_NOSPC = 28
NFS4ERR_ROFS = 30
NFS4ERR_MLINK = 31
NFS4ERR_NAMETOOLONG = 63
NFS4ERR_NOTEMPTY = 66
NFS4ERR_DQUOT = 69
NFS4ERR_STALE = 70
NFS4ERR_BADHANDLE = 10001
NFS4ERR_BAD_COOKIE = 10003
NFS4ERR_NOTSUPP = 10004
NFS4ERR_TOOSMALL = 10005
NFS4ERR_SERVERFAULT = 10006
NFS4ERR_BADTYPE = 10007
NFS4ERR_DELAY = 10008
NFS4ERR_SAME = 10009
NFS4ERR_DENIED = 10010
NFS4ERR_EXPIRED = 10011
NFS4ERR_LOCKED = 10012
NFS4ERR_GRACE = 10013
NFS4ERR_FHEXPIRED = 10014
NFS4ERR_SHARE_DENIED = 10015
NFS4ERR_WRONGSEC = 10016
NFS4ERR_CLID_INUSE = 10017
NFS4ERR_RESOURCE = 10018
NFS4ERR_MOVED = 10019
NFS4ERR_NOFILEHANDLE = 10020
NFS4ERR_MINOR_VERS_MISMATCH = 10021
NFS4ERR_STALE_CLIENTID = 10022
NFS4ERR_STALE_STATEID = 10023
NFS4ERR_OLD_STATEID = 10024
NFS4ERR_BAD_STATEID = 10025
NFS4ERR_BAD_SEQID = 10026
NFS4ERR_NOT_SAME = 10027
NFS4ERR_LOCK_RANGE = 10028
NFS4ERR_SYMLINK = 10029
NFS4ERR_RESTOREFH = 10030
NFS4ERR_LEASE_MOVED = 10031
NFS4ERR_ATTRNOTSUPP = 10032
NFS4ERR_NO_GRACE = 10033
NFS4ERR_RECLAIM_BAD = 10034
NFS4ERR_RECLAIM_CONFLICT = 10035
NFS4ERR_BADXDR = 10036
NFS4ERR_LOCKS_HELD = 10037
NFS4ERR_OPENMODE = 10038

# Access mask bits
ACCESS_READ = 0x01
ACCESS_LOOKUP = 0x02
ACCESS_MODIFY = 0x04
ACCESS_EXTEND = 0x08
ACCESS_DELETE = 0x10
ACCESS_EXECUTE = 0x20

# File types
NF_REG = 1    # Regular file
NF_DIR = 2    # Directory
NF_BLK = 3    # Block device
NF_CHR = 4    # Character device
NF_LNK = 5    # Symbolic link
NF_SOCK = 6   # Socket
NF_FIFO = 7   # FIFO

# RPC Authentication flavors
AUTH_NULL = 0
AUTH_UNIX = 1
AUTH_SHORT = 2
AUTH_DH = 3
AUTH_KERB = 4
AUTH_RSA = 5

# Common ports
PORTMAPPER_PORT = 111
NFS_PORT = 2049

# RPC constants
RPC_CALL = 0
RPC_REPLY = 1

# RPC reply states
MSG_ACCEPTED = 0
MSG_DENIED = 1

# RPC accept states
SUCCESS = 0
PROG_UNAVAIL = 1
PROG_MISMATCH = 2
PROC_UNAVAIL = 3
GARBAGE_ARGS = 4
SYSTEM_ERR = 5

# NFS status codes
NFS_OK = 0
NFSERR_PERM = 1
NFSERR_NOENT = 2
NFSERR_IO = 5
NFSERR_NXIO = 6
NFSERR_ACCES = 13
NFSERR_EXIST = 17
NFSERR_XDEV = 18
NFSERR_NODEV = 19
NFSERR_NOTDIR = 20
NFSERR_ISDIR = 21
NFSERR_INVAL = 22
NFSERR_FBIG = 27
NFSERR_NOSPC = 28
NFSERR_ROFS = 30
NFSERR_MLINK = 31
NFSERR_NAMETOOLONG = 63
NFSERR_NOTEMPTY = 66
NFSERR_DQUOT = 69
NFSERR_STALE = 70
NFSERR_REMOTE = 71
NFSERR_WFLUSH = 99

# NFS error messages
NFS_ERROR_MESSAGES = {
    NFS_OK: "Success",
    NFSERR_PERM: "Permission denied",
    NFSERR_NOENT: "No such file or directory",
    NFSERR_IO: "I/O error",
    NFSERR_NXIO: "No such device or address",
    NFSERR_ACCES: "Permission denied",
    NFSERR_EXIST: "File exists",
    NFSERR_XDEV: "Cross-device link",
    NFSERR_NODEV: "No such device",
    NFSERR_NOTDIR: "Not a directory",
    NFSERR_ISDIR: "Is a directory",
    NFSERR_INVAL: "Invalid argument",
    NFSERR_FBIG: "File too large",
    NFSERR_NOSPC: "No space left on device",
    NFSERR_ROFS: "Read-only file system",
    NFSERR_MLINK: "Too many links",
    NFSERR_NAMETOOLONG: "File name too long",
    NFSERR_NOTEMPTY: "Directory not empty",
    NFSERR_DQUOT: "Disc quota exceeded",
    NFSERR_STALE: "Stale NFS file handle",
    NFSERR_REMOTE: "Too many levels of remote in path",
    NFSERR_WFLUSH: "Write cache flushed"
}

# Default chunk sizes
DEFAULT_READ_SIZE = 8192
DEFAULT_WRITE_SIZE = 8192
MAX_READ_SIZE = 65536
MAX_WRITE_SIZE = 65536
